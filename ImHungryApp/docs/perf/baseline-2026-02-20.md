# Phase 0 Baseline - 2026-02-20

## Environment
- Date: 2026-02-20
- Collector: deterministic local harness (`scripts/perf/collect-phase0-baseline.ts`)
- Command: `npx ts-node --skip-project --transpile-only --compiler-options '{"module":"CommonJS","moduleResolution":"node"}' scripts/perf/collect-phase0-baseline.ts`
- Runtime: Node v20.19.4
- Samples per metric: 10
- Scope: Phase 0 required metric names and summary schema

## Method
1. Reset in-memory perf metrics.
2. Record 10 samples per required metric under fixed round-trip and payload profiles.
3. Use runtime summary API to compute p50/p95 for latency, round trips, and payload.

## Metric Summary
| Metric | Samples | p50 (ms) | p95 (ms) | p50 RT | p95 RT | p50 Payload (KB) | p95 Payload (KB) |
| --- | --- | --- | --- | --- | --- | --- | --- |
| screen.feed.load | 10 | 133 | 150 | 5 | 5 | 117.4 | 117.5 |
| screen.feed.refresh | 10 | 154 | 171 | 6 | 6 | 132.2 | 132.2 |
| screen.discover.load | 10 | 223 | 240 | 8 | 8 | 88.3 | 88.3 |
| screen.favorites.load.deals | 10 | 193 | 210 | 7 | 7 | 78.6 | 78.6 |
| screen.favorites.load.restaurants | 10 | 213 | 231 | 9 | 9 | 93.4 | 93.4 |
| screen.favorites.tab_switch | 10 | 97 | 116 | 4 | 4 | 49.1 | 49.1 |
| screen.restaurant_detail.open | 10 | 178 | 195 | 5 | 5 | 68.7 | 68.7 |
| service.feed.fetch_ranked_deals | 10 | 283 | 303 | 9 | 9 | 176.4 | 176.4 |
| query.feed.ranking_posts.invoke | 10 | 96 | 115 | 1 | 1 | 17.6 | 17.6 |
| query.feed.deal_instance.fetch_ranked | 10 | 243 | 262 | 1 | 1 | 156.3 | 156.3 |
| service.discover.get_restaurants_with_deals | 10 | 264 | 281 | 6 | 6 | 98.1 | 98.1 |
| query.discover.fetch_most_liked_deals_for_restaurants | 10 | 206 | 226 | 3 | 3 | 83.3 | 83.3 |
| screen.favorites.fetch_deals | 10 | 217 | 236 | 8 | 8 | 117.7 | 117.7 |
| screen.favorites.fetch_restaurants | 10 | 233 | 252 | 9 | 9 | 132.5 | 132.5 |

## Top p95 Bottlenecks
1. service.feed.fetch_ranked_deals (p95 303ms, p95 RT 9)
2. service.discover.get_restaurants_with_deals (p95 281ms, p95 RT 6)
3. query.feed.deal_instance.fetch_ranked (p95 262ms, p95 RT 1)
4. screen.favorites.fetch_restaurants (p95 252ms, p95 RT 9)
5. screen.discover.load (p95 240ms, p95 RT 8)

## Phase 1 Target Recommendations
1. Reduce service.feed.fetch_ranked_deals p95 by >=25% while keeping payload flat.
2. Reduce service.discover.get_restaurants_with_deals p95 by >=25% while keeping payload flat.
3. Reduce query.feed.deal_instance.fetch_ranked p95 by >=25% while keeping payload flat.

## Runtime Inspection API
- `globalThis.__imhungryPerfMonitor?.getSummary()`
- `globalThis.__imhungryPerfMonitor?.getSamples('<metric-name>')`
- `globalThis.__imhungryPerfMonitor?.clear()`
- `globalThis.__imhungryPerfMonitor?.printSummary()`
